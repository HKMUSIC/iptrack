<!DOCTYPE html>
<html>
<head>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <title>Vote Confirmation</title>
    <style>
        body { background: #1c1c1c; color: white; text-align: center; font-family: sans-serif; padding: 20px; }
        .btn { background: #3498db; color: white; border: none; padding: 15px 30px; border-radius: 10px; font-size: 18px; cursor: pointer; margin-top: 20px; }
        #status { margin-top: 20px; color: #aaa; }
    </style>
</head>
<body>
    <h3>Device Verification</h3>
    <p>Click below to securely record your vote. This prevents multiple ID abuse from the same device.</p>
    
    <button class="btn" id="voteBtn">Confirm My Vote âš¡</button>
    <p id="status">Ready to verify...</p>

    <script>
        const tele = window.Telegram.WebApp;
        tele.ready();
        tele.expand();

        document.getElementById('voteBtn').onclick = function() {
            document.getElementById('status').innerText = "Fetching IP...";
            this.disabled = true;

            fetch('https://api.ipify.org?format=json')
                .then(response => response.json())
                .then(data => {
                    const userIp = data.ip;
                    const urlParams = new URLSearchParams(window.location.search);
                    const entryId = urlParams.get('id');

                    // Data bot ko bhej rahe hain
                    tele.sendData(entryId + "|" + userIp);
                })
                .catch(err => {
                    alert("Network Error! Try again.");
                    this.disabled = false;
                });
        };
    </script>
</body>
</html>
